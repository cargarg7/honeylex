#!/usr/bin/env php
<?php

use Honeybee\FrameworkBinding\Silex\Console\App;
use Honeybee\FrameworkBinding\Silex\Console\Command\Crate\CrateInfo;
use Honeybee\FrameworkBinding\Silex\Console\Command\Crate\ListCrates;
use Honeybee\FrameworkBinding\Silex\Console\Command\Crate\MakeCrate;
use Honeybee\FrameworkBinding\Silex\Console\Command\Crate\RemoveCrate;
use Honeybee\FrameworkBinding\Silex\Console\Command\Hello;
use Honeybee\FrameworkBinding\Silex\Console\Command\Migrate\ListTargets;
use Honeybee\FrameworkBinding\Silex\Console\Command\Migrate\MigrateDown;
use Honeybee\FrameworkBinding\Silex\Console\Command\Migrate\MigrateUp;
use Honeybee\FrameworkBinding\Silex\Console\Command\Migrate\TargetInfo;
use Symfony\Component\Console\Input\ArgvInput;

$appContext = 'console';
$localConfigDir = getenv('LOCAL_CONFIG_DIR') ?: '/usr/local/honeylex.local/';
$appCommands = [
    CrateInfo::CLASS,
    Hello::CLASS,
    ListCrates::CLASS,
    ListTargets::CLASS,
    MakeCrate::CLASS,
    MigrateDown::CLASS,
    MigrateUp::CLASS,
    RemoveCrate::CLASS,
    TargetInfo::CLASS,
];

require_once __DIR__.'/../vendor/autoload.php';

set_time_limit(0);

$appEnv = (new ArgvInput)->getParameterOption([ '--env', '-e' ], getenv('APP_ENV') ?: 'dev');

$app = require __DIR__.'/../app/bootstrap.php';

$appState = [ ':app' => $app, ':appCommands' => $appCommands ];
$app['honeybee.service_locator']->createEntity(App::CLASS, $appState)->run();
